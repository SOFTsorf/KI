<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KI Assistent - Fix</title>
    <style>
        body { font-family: sans-serif; background: #121212; color: white; display: flex; justify-content: center; padding: 20px; }
        .chat-card { width: 100%; max-width: 400px; background: #1e1e1e; border-radius: 15px; display: flex; flex-direction: column; height: 80vh; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        #display { flex: 1; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 10px; }
        .msg { padding: 10px; border-radius: 10px; max-width: 80%; font-size: 14px; }
        .u { align-self: flex-end; background: #007bff; }
        .a { align-self: flex-start; background: #333; }
        .err { background: #4a1a1a; color: #ff8888; align-self: center; width: 100%; text-align: center; }
        .input-box { display: flex; padding: 15px; gap: 10px; border-top: 1px solid #333; }
        input { flex: 1; padding: 10px; border-radius: 5px; border: none; background: #2d2d2d; color: white; }
        button { cursor: pointer; background: #007bff; border: none; color: white; padding: 10px; border-radius: 5px; }
    </style>
</head>
<body>

<div class="chat-card">
    <div id="display">
        <div class="msg a">System bereit. Ohne Guthaben wird die KI jedoch mit "402 Payment Required" antworten.</div>
    </div>
    <div class="input-box">
        <input type="text" id="textIn" placeholder="Nachricht...">
        <button id="sendBtn">Senden</button>
    </div>
</div>

<script>
    // DEIN KEY HIER
    const MY_KEY = 'DEIN_KEY_STARTEND_MIT_SK'; 

    const display = document.getElementById('display');
    const textIn = document.getElementById('textIn');
    const sendBtn = document.getElementById('sendBtn');

    async function sendMessage() {
        const val = textIn.value.trim();
        if (!val) return;

        // User Nachricht anzeigen
        const uDiv = document.createElement('div');
        uDiv.className = 'msg u';
        uDiv.innerText = val;
        display.appendChild(uDiv);
        textIn.value = '';

        try {
            const response = await fetch("https://api.openai.com/v1/chat/completions", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                    "Authorization": `Bearer ${MY_KEY}`
                },
                body: JSON.stringify({
                    model: "gpt-3.5-turbo",
                    messages: [{role: "user", content: val}]
                })
            });

            const data = await response.json();

            if (!response.ok) {
                // PrÃ¤zise Fehlermeldung (z.B. kein Geld)
                throw new Error(data.error ? data.error.message : "Unbekannter Fehler");
            }

            const aiMsg = data.choices[0].message.content;
            const aDiv = document.createElement('div');
            aDiv.className = 'msg a';
            aDiv.innerText = aiMsg;
            display.appendChild(aDiv);

        } catch (err) {
            const eDiv = document.createElement('div');
            eDiv.className = 'msg err';
            eDiv.innerText = "Fehler: " + err.message;
            display.appendChild(eDiv);
        }
        display.scrollTop = display.scrollHeight;
    }

    sendBtn.onclick = sendMessage;
    textIn.onkeypress = (e) => { if(e.key === 'Enter') sendMessage(); };
</script>

</body>
</html>
                    body: JSON.stringify({ model: "gpt-3.5-turbo", messages: [{role: "user", content: text}] })
                });
                const data = await res.json();
                const reply = data.choices[0].message.content;
                box.innerHTML += `<div class="ai">KI: ${reply}</div>`;
                
                // Sprache
                const s = new SpeechSynthesisUtterance(reply);
                s.lang = 'de-DE';
                window.speechSynthesis.speak(s);
            } catch (e) {
                box.innerHTML += `<div class="ai">Fehler: Key prÃ¼fen oder Guthaben leer.</div>`;
            }
            box.scrollTop = box.scrollHeight;
        }
    </script>
</body>
</html>
            border: none; background: #007bff; color: white; 
            width: 48px; height: 48px; border-radius: 50%; 
            cursor: pointer; font-size: 20px; transition: 0.3s;
            display: flex; justify-content: center; align-items: center;
        }
        button:hover { background: #0056b3; transform: scale(1.05); }
        .mic-btn.active { background: #ff3b30; animation: pulse 1.2s infinite; }
        
        @keyframes pulse { 0% { box-shadow: 0 0 0 0 rgba(255,59,48,0.7); } 70% { box-shadow: 0 0 0 15px rgba(255,59,48,0); } 100% { box-shadow: 0 0 0 0 rgba(255,59,48,0); } }
    </style>
</head>
<body>

<div class="chat-container">
    <div id="chat-box">
        <div class="message ai">Bereit! Tippe etwas oder klicke auf das Mikrofon, um mit mir zu sprechen.</div>
    </div>
    <div class="input-area">
        <input type="text" id="user-input" placeholder="Nachricht..." autocomplete="off">
        <button id="mic-btn" title="Sprechen">ðŸŽ¤</button>
        <button id="send-btn">âž¤</button>
    </div>
</div>

<script>
    const chatBox = document.getElementById('chat-box');
    const userInput = document.getElementById('user-input');
    const sendBtn = document.getElementById('send-btn');
    const micBtn = document.getElementById('mic-btn');

    // Dein SchlÃ¼ssel wurde hier eingesetzt
    const apiKey = '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'; 

    let memory = [
        { role: "system", content: "Du bist ein intelligenter Sprachassistent. Antworte kurz, prÃ¤zise und freundlich auf Deutsch." }
    ];

    function speak(text) {
        window.speechSynthesis.cancel(); // Stoppt laufende Sprachausgabe
        const utterance = new SpeechSynthesisUtterance(text);
        utterance.lang = 'de-DE';
        window.speechSynthesis.speak(utterance);
    }

    function addMessage(text, sender) {
        const msgDiv = document.createElement('div');
        msgDiv.classList.add('message', sender);
        msgDiv.innerText = text;
        chatBox.appendChild(msgDiv);
        chatBox.scrollTop = chatBox.scrollHeight;
    }

    async function fetchAIResponse(userText) {
        const loadingDiv = document.createElement('div');
        loadingDiv.classList.add('message', 'ai');
        loadingDiv.innerText = "...";
        chatBox.appendChild(loadingDiv);

        memory.push({ role: "user", content: userText });

        try {
            const response = await fetch("https://api.openai.com/v1/chat/completions", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                    "Authorization": `Bearer ${apiKey}`
                },
                body: JSON.stringify({
                    model: "gpt-3.5-turbo",
                    messages: memory
                })
            });

            const data = await response.json();
            if (data.error) throw new Error(data.error.message);
            
            const aiText = data.choices[0].message.content;
            memory.push({ role: "assistant", content: aiText });

            chatBox.removeChild(loadingDiv);
            addMessage(aiText, 'ai');
            speak(aiText);

        } catch (error) {
            chatBox.removeChild(loadingDiv);
            addMessage("Fehler: " + error.message, 'ai');
        }
    }

    function handleSend() {
        const text = userInput.value.trim();
        if (text !== "") {
            addMessage(text, 'user');
            userInput.value = "";
            fetchAIResponse(text);
        }
    }

    sendBtn.addEventListener('click', handleSend);
    userInput.addEventListener('keypress', (e) => { if (e.key === 'Enter') handleSend(); });

    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
    if (SpeechRecognition) {
        const recognition = new SpeechRecognition();
        recognition.lang = 'de-DE';

        micBtn.addEventListener('click', () => {
            recognition.start();
            micBtn.classList.add('active');
        });

        recognition.onresult = (event) => {
            const transcript = event.results[0][0].transcript;
            userInput.value = transcript;
            micBtn.classList.remove('active');
            handleSend();
        };

        recognition.onspeechend = () => {
            recognition.stop();
            micBtn.classList.remove('active');
        };

        recognition.onerror = () => micBtn.classList.remove('active');
    }
</script>

</body>
</html>
            width: 45px; height: 45px; border-radius: 50%; 
            cursor: pointer; font-size: 18px; transition: 0.2s;
        }
        button:hover { background: #0056b3; transform: scale(1.05); }
        button:active { transform: scale(0.95); }
        .mic-btn.active { background: #ff3b30; animation: pulse 1.5s infinite; }
        
        @keyframes pulse { 0% { box-shadow: 0 0 0 0 rgba(255,59,48,0.7); } 70% { box-shadow: 0 0 0 10px rgba(255,59,48,0); } 100% { box-shadow: 0 0 0 0 rgba(255,59,48,0); } }
        
        /* Scrollbar Styling */
        #chat-box::-webkit-scrollbar { width: 6px; }
        #chat-box::-webkit-scrollbar-thumb { background: #444; border-radius: 10px; }
    </style>
</head>
<body>

<div class="chat-container">
    <div id="chat-box">
        <div class="message ai">Hallo! Ich bin deine intelligente KI. Du kannst mit mir schreiben oder sprechen. Wie kann ich helfen?</div>
    </div>
    <div class="input-area">
        <input type="text" id="user-input" placeholder="Frag mich etwas..." autocomplete="off">
        <button id="mic-btn" class="mic-btn">ðŸŽ¤</button>
        <button id="send-btn">âž¤</button>
    </div>
</div>

<script>
    const chatBox = document.getElementById('chat-box');
    const userInput = document.getElementById('user-input');
    const sendBtn = document.getElementById('send-btn');
    const micBtn = document.getElementById('mic-btn');

    // HIER DEINEN API-KEY EINTRAGEN
    const apiKey = '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'; 

    // Das GedÃ¤chtnis der KI (Context)
    let memory = [
        { role: "system", content: "Du bist ein hilfreicher, freundlicher KI-Assistent. Antworte prÃ¤zise und auf Deutsch." }
    ];

    // 1. Sprachausgabe
    function speak(text) {
        const utterance = new SpeechSynthesisUtterance(text);
        utterance.lang = 'de-DE';
        window.speechSynthesis.speak(utterance);
    }

    // 2. Nachricht im UI anzeigen
    function addMessage(text, sender) {
        const msgDiv = document.createElement('div');
        msgDiv.classList.add('message', sender);
        msgDiv.innerText = text;
        chatBox.appendChild(msgDiv);
        chatBox.scrollTop = chatBox.scrollHeight;
    }

    // 3. Echte KI-Abfrage (OpenAI)
    async function fetchAIResponse(userText) {
        // Lade-Indikator
        const loadingDiv = document.createElement('div');
        loadingDiv.classList.add('message', 'ai');
        loadingDiv.innerText = " KI schreibt...";
        chatBox.appendChild(loadingDiv);
        chatBox.scrollTop = chatBox.scrollHeight;

        // User Nachricht zum GedÃ¤chtnis hinzufÃ¼gen
        memory.push({ role: "user", content: userText });

        try {
            const response = await fetch("https://api.openai.com/v1/chat/completions", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                    "Authorization": `Bearer ${apiKey}`
                },
                body: JSON.stringify({
                    model: "gpt-3.5-turbo",
                    messages: memory,
                    temperature: 0.7
                })
            });

            const data = await response.json();
            const aiText = data.choices[0].message.content;

            // Nachricht zum GedÃ¤chtnis hinzufÃ¼gen
            memory.push({ role: "assistant", content: aiText });

            // UI aktualisieren
            chatBox.removeChild(loadingDiv);
            addMessage(aiText, 'ai');
            speak(aiText);

        } catch (error) {
            chatBox.removeChild(loadingDiv);
            addMessage("Fehler: Verbindung zur KI fehlgeschlagen. Hast du einen gÃ¼ltigen API-Key eingetragen?", 'ai');
            console.error(error);
        }
    }

    // 4. Events fÃ¼r Tipp-Feature
    function handleSend() {
        const text = userInput.value.trim();
        if (text !== "") {
            addMessage(text, 'user');
            userInput.value = "";
            fetchAIResponse(text);
        }
    }

    sendBtn.addEventListener('click', handleSend);
    userInput.addEventListener('keypress', (e) => { if (e.key === 'Enter') handleSend(); });

    // 5. Spracherkennung (Voice-Feature)
    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
    if (SpeechRecognition) {
        const recognition = new SpeechRecognition();
        recognition.lang = 'de-DE';
        recognition.interimResults = false;

        micBtn.addEventListener('click', () => {
            recognition.start();
            micBtn.classList.add('active');
        });

        recognition.onresult = (event) => {
            const transcript = event.results[0][0].transcript;
            userInput.value = transcript;
            micBtn.classList.remove('active');
            handleSend();
        };

        recognition.onerror = () => micBtn.classList.remove('active');
        recognition.onspeechend = () => recognition.stop();
    } else {
        micBtn.style.display = "none";
    }
</script>

</body>
</html>
    const userInput = document.getElementById('user-input');
    const sendBtn = document.getElementById('send-btn');
    const micBtn = document.getElementById('mic-btn');

    // 1. Sprachausgabe (KI spricht)
    function speak(text) {
        const utterance = new SpeechSynthesisUtterance(text);
        utterance.lang = 'de-DE';
        window.speechSynthesis.speak(utterance);
    }

    // 2. Chat-Verlauf aktualisieren
    function addMessage(text, sender) {
        const msgDiv = document.createElement('div');
        msgDiv.classList.add('message', sender);
        msgDiv.innerText = text;
